---
cart: true

---
{{#partial "page"}}
{{inject "testingThing" "thing"}}
{{inject "storefrontToken" settings.storefront_api.token}}
<script>
  const jsContext = JSON.parse({{jsContext}});
</script>

<div class="configurator">

  <section class="configurator__banner">
    <h1 class="title configurator__title">COMPASS 800 SERIES DOOR PULL CONFIGURATOR</h1>
    <p class="configurator__subtitle title--section">Fill in the form to see what you'll need to build your custom door pull system</p>
  </section>
<button id="test-fill-all">Testing - Fill all values</button>
<section class="configurator__content">
  <form id="configurator-form">
    <div class="configurator__region">
      <h2 class="configurator__section-header title--sub">Door Specifications</h2>
      <div class="configurator__field-wrap">
        <label class="configurator__label" for="door-material-selector">Door Material*</label>
        <select name="door-material" id="door-material-selector" required>
          <option disabled selected value> -- SELECT AN OPTION -- </option>
          <option value="glass">Glass</option>
          <option value="metal">Metal</option>
          <option value="wood">Wood</option>
        </select>
      </div>
      <div class="configurator__field-wrap">
        <label class="configurator__label" for="door-thickness-inout">Door Thickness* (inches)</label>
        <input type="number" name="door-thickness" id="door-thickness-input" min="0.10" max="24" step=".01" required />
      </div>
    </div>

    <div class="configurator__region">
      <h2 class="configurator__section-header title--sub">Grip Selection</h2>
      <div class="configurator__field-wrap" id="grip-type-container">
        <label class="configurator__label" for="grip-type">Grip Type*</label>
        <select name="grip-type" id="grip-type-selector" required>
          <option disabled selected value> -- SELECT AN OPTION -- </option>
          <option value="straight">Straight</option>
          <option value="round-ends">Round Ends - 14.75″</option>
          <option value="semi-circle">Semi-circle - 10.875″</option>
          <option value="arc">Arc - 14.25″</option>
        </select>
      </div>

      <div class="configurator__field-wrap" id="grip-length-container">
        <label class="configurator__label" for="grip-length-input">Overall Length* (inches)</label>
        <input name="grip-length" type="number" id="grip-length-input" name="grip-length" min="6" max="92" step=".001" required>
      </div>

      <div class="configurator__field-wrap" id="grip-finish-container">
        <label class="configurator__label" for="grip-finish-selector">Grip Finish*</label>
        <select name="grip-finish" id="grip-finish-selector" required>
          <option disabled selected value> -- SELECT AN OPTION -- </option>
          <option value="satin-stainless">Satin Stainless</option>
          <option value="polished-stainless">Polished Stainless</option>
          <option value="stippled-stainless">Stippled Stainless Steel</option>
        </select>
      </div>

      <div class="configurator__field-wrap" id="grip-cc-container">
        <label class="configurator__label" for="grip-cc-input">Grip Center to Center Measurement* (inches)</label>
        <input type="number" name="grip-cc" id="grip-cc-input" required />
      </div>

      <div class="configurator__field-wrap" id="grip-mount-container">
        <label class="configurator__label" for="grip-mount-selector">Mount Option*</label>
        <select name="grip-mount" id="grip-mount-selector" required>
          <option disabled selected value> -- SELECT AN OPTION -- </option>
          <option value="b1">B1 - Single Mount - Solid wood core or hollow metal door with through mount</option>
          <option value="b2">B2 - Single Mount - Tempered glass, solid wood core or hollow metal door with end cap purchased separately</option>
          <option value="b3">B3 - Concealed Single Mount - Hollow metal door with roto-lok and customer's reinforcement</option>
          <option value="b4">B4 - Concealed Single Mount - Solid wood core door with threaded insert and rota-lok (not recommended)</option>
          <option value="b5">B5 - Back-to-Back - Solid wood core or hollow metal door with rota-lok</option>
          <option value="b6">B6 - Back-to-Back - Tempered glass door with rota-lok</option>
        </select>
      </div>
    </div>

    <br />
    <h2 class="configurator__section-header title--sub">Standoff Selection</h2>
    <div class="configurator__field-wrap" id="standoff-type-container">
      <label class="configurator__label" for="standoff-type-selector">Standoff Type*</label>
      <select name="standoff-type" id="standoff-type-selector" required>
        <option disabled selected value> -- SELECT AN OPTION -- </option>
        <option value="ring">Ring</option>
        <option value="double-ring">Double Ring</option>
        <option value="clamshell">Clamshell</option>
        <option value="bullet">Bullet</option>
        <option value="cylinder">Cylinder</option>
      </select>
    </div>
    
    <div class="configurator__field-wrap" id="standoff-finish-container">
      <label class="configurator__label" for="standoff-finish-selector">Standoff Finish*</label>
      <select name="standoff-finish" id="standoff-finish-selector" required>
        <option disabled selected value> -- SELECT AN OPTION -- </option>
        <option value="satin-stainless">Satin Stainless</option>
        <option value="polished-stainless">Polished Stainless</option>
        <option value="stippled-stainless">Stippled Stainless Steel</option>
        <option value="satin-bronze">Satin Bronze</option>
        <option value="polished-bronze">Polished Bronze</option>
        <option value="oil-bronze">Oil Rubbed Bronze</option>
        <option value="stippled-bronze">Stippled Bronze</option>
        <option value="stippled-oil-bronze">Stippled Oil Rubbed Bronze</option>
      </select>
    </div>

    <br />
    <div id="endcap-finish-container">
      <h2 class="configurator__section-header title--sub">Endcaps</h2>
      <div class="configurator__field-wrap">
        <label class="configurator__label" for="endcap-finish-selector">Endcap Finish*</label>
        <select name="endcap-finish" id="endcap-finish-selector" required>
          <option disabled selected value> -- SELECT AN OPTION -- </option>
          <option value="satin-stainless">Satin Stainless</option>
          <option value="polished-stainless">Polished Stainless</option>
          <option value="stippled-stainless">Stippled Stainless Steel</option>
          <option value="satin-bronze">Satin Bronze</option>
          <option value="polished-bronze">Polished Bronze</option>
          <option value="oil-bronze">Oil Rubbed Bronze</option>
          <option value="stippled-bronze">Stippled Bronze</option>
          <option value="stippled-oil-bronze">Stippled Oil Rubbed Bronze</option>
        </select>
      </div>
    </div>

    <button type="submit" class="btn">Calculate</button>
  </form>

  <div class="configurator__results" id="results">
    <div class="configurator__placeholder" id="results--placeholder">
      <p>Fill form to view summary and required skus...</p>
    </div>
    <div style="display: none;" id="results--populated">
      <div class="configurator__results--region">
        <h2 class="configurator__section-header title--sub">Specifications Summary</h2>
        <p>Door Type: <span id="results--door-material"></span></p>
        <p>Door Thickness: <span id="results--door-thickness"></span></p>
        <p>Grip Type: <span id="results--grip-type"></span></p>
        <p>Grip Length: <span id="results--grip-length"></span></p>
        <p>Grip Finish: <span id="results--grip-finish"></span></p>
        <p>Grip Center to Center: <span id="results--grip-cc"></span></p>
        <p>Total Standoffs: <span id="results--total-standoffs"></span></p>
        <p>Standoff Type: <span id="results--standoff-type"></span></p>
        <p>Standoff Finish: <span id="results--standoff-finish"></span></p>
        <p>Total Endcaps: <span id="results--total-endcaps"></span></p>
        <p>Endcap Finish: <span id="results--endcap-finish"></span></p>
      </div>
      <div class="configurator__results--region">
        <h2 class="configurator__section-header title--sub">List of SKUS to purchase:</h2>
        <ul id="results--total-skus"></ul>
        <h2 class="configurator__section-header total title--sub">Total price: <span id="results--total-price"></span></h2>
        <button id="add-to-cart-button" class="btn">Add all to cart</button>
      </div>
    </div>
  </div>
</section>

</div>

{{> components/common/home-info}}
{{/partial}}

{{> layout/base}}

<!-- <script>


  const skuList = [];

  function getGripSize (gripType, gripLength) {
    if (gripType != 'straight') {
      return gripType;
    }
    if (gripLength <= 14.75) {
      return 'small'
    } else if (gripLength > 14.75 && gripLength <= 34.75) {
      return 'medium'
    } else if (gripLength > 34.75 && gripLength <= 64.75) {
      return 'large'
    } else if (gripLength > 64.75) {
      return 'giant'
    }
  }

  function handleGripTypeChange(event) {
    const gripType = event.target.value;
    if (gripType === 'straight') {
      document.querySelector('#grip-length').value = '';
      document.querySelector('#grip-length').removeAttribute('readonly');
    } else {
      document.querySelector('#grip-length').setAttribute('readonly', true);
      switch(gripType) {
        case 'round-ends':
          document.querySelector('#grip-length').value = 14.75;
          break;
        case 'semi-circle':
          document.querySelector('#grip-length').value = 10.875;
          break;
        case 'arc':
          document.querySelector('#grip-length').value = 14.25;
          break;
      }
    }
  }

  function handleGripMountChange(event) {
    gripMount = event.target.value;
    if (gripMount === 'b5' || gripMount === 'b6') {
      document.querySelector('#endcap-finish-container select').required = false;
      document.querySelector('#endcap-finish-container').style.display = 'none';
    } else {
      document.querySelector('#endcap-finish-container select').required = true;
      document.querySelector('#endcap-finish-container').style.display = 'block';
    }
  }

  function handleSubmit(event) {
    event.preventDefault();

    // Serialize form data
    const formData = new FormData(event.target);
    const data = {};
	  for (var key of formData.keys()) {
		  data[key] = formData.get(key);
	  }

    [doorMaterial, doorThickness, gripType, gripLength, gripFinish, gripCC, gripMount, standoffType, standoffFinish, endcapFinish] = Object.values(data);
    let price = 0;
    let isDoubleMounted = gripMount == 'b5' || gripMount == 'b6';
  
    // Populate Door Specifications
    document.querySelector('#results--door-material').textContent = doorMaterial;
    document.querySelector('#results--door-thickness').textContent = doorThickness;

    // Populate Grip Specifications
    document.querySelector('#results--grip-type').textContent = gripType;
    document.querySelector('#results--grip-length').textContent = gripLength;
    document.querySelector('#results--grip-finish').textContent = gripFinish;
    document.querySelector('#results--grip-cc').textContent = gripCC;

    // Calculate grip price & SKU
    const gripQuantity = isDoubleMounted ? 2 : 1;
    const gripPrice = gripData[getGripSize(gripType, gripLength)][gripFinish].price;
    const gripSku = gripData[getGripSize(gripType, gripLength)][gripFinish].sku;
    skuList.push(gripSku);
    price += gripPrice * gripQuantity;

    // Add SKU to list
    const gripNode = document.createElement('li');
    gripNode.textContent = `Grip: ${gripSku} - $${gripPrice} x${gripQuantity}`;
    document.querySelector('#results--total-skus').append(gripNode);

    // Calculate standoffs
    let totalStandoffs = Math.floor(gripCC / 30) + 2;
    if (isDoubleMounted) {
      totalStandoffs *= 2;
    }

    // Populate standoff information
    document.querySelector('#results--total-standoffs').textContent = totalStandoffs;
    document.querySelector('#results--standoff-type').textContent = standoffType;
    document.querySelector('#results--standoff-finish').textContent = standoffFinish;

    const standoffPrice = standoffData[standoffType][standoffFinish].price;
    const standoffSku = standoffData[standoffType][standoffFinish].sku;
    skuList.push(standoffSku);

    price += (standoffPrice * totalStandoffs);
    const standoffNode = document.createElement('li');
    standoffNode.textContent = `Standoff: ${standoffSku} - $${standoffPrice} x ${totalStandoffs}`;
    document.querySelector('#results--total-skus').append(standoffNode);

    // Calculate endcaps
    let totalEndcaps = 0;

    if (isDoubleMounted) {
      document.querySelector('#results--endcap-finish').textContent = 'n/a';
      document.querySelector('#results--total-endcaps').textContent = 'n/a';
    } else {
      totalEndcaps = totalStandoffs;
      document.querySelector('#results--endcap-finish').textContent = endcapFinish;
      document.querySelector('#results--total-endcaps').textContent = totalEndcaps;

      const endcapPrice = endcapData[endcapFinish].price;
      const endcapSku = endcapData[endcapFinish].sku;
      skuList.push(endcapSku);
      price += (endcapPrice * totalEndcaps);
      const endcapNode = document.createElement('li');
      endcapNode.textContent = `Endcap: ${endcapSku} - $${endcapPrice} x ${totalEndcaps}`;
      document.querySelector('#results--total-skus').append(endcapNode);
    }

    // Final price
    document.querySelector('#results--total-price').textContent = `$${price}`;

    // Show Results panel and hide placeholder text
    document.querySelector('#results--placeholder').style.display = 'none';
    document.querySelector('#results--populated').style.display = 'block';
  }

  // Helper function to get variant ID from productID
  // async function fetchVariantID(productID) {
  //   return fetch(`https://api.bigcommerce.com/stores/40wxilo4jg/v3/catalog/products/)
  // }

  function handleAddToCart() {
    // Get variant ID for each SKU

    // Get modifier IDs for grip SKU

    // Build lineitem array with provided IDs

    // Check if cart exists
  //   fetch("/api/storefront/carts", {
  //   method: "GET",
  //   headers: { "Content-Type": "application/json" },
  // })
  //   .then((response) => response.json())
  //   .then((response) => {
  //         })
    // If cart exists, add lineitems to cart

    // If cart does not exist, create cart and add lineitems to cart
  }

handleAddToCart();
</script> -->
